{% extends "base.html" %}
{% block content %}
<h2>Generador - Cuadrados Medios</h2>
<form method="POST">
  <div class="mb-3">
    <label>Semilla:</label>
    <input type="number" name="semilla" class="form-control" required value="{{ semilla }}">
  </div>
  <div class="mb-3">
    <label>Iteraciones:</label>
    <input type="number" name="iteraciones" class="form-control" required value="{{ n }}">
  </div>
  <button type="submit" class="btn btn-primary">Generar</button>
  <button formaction="/export_cuadrados_csv" formmethod="POST" class="btn btn-success">Exportar CSV</button>
  <button formaction="/export_ri_cuadrados" formmethod="POST" class="btn btn-success">Exportar Ri</button>
  <button formaction="/grafico_serie_cuadrados" formmethod="POST" class="btn btn-warning">Ver Serie Temporal</button>
  <a href="/cargar_semillas_cuadrados" class="btn btn-secondary">Cargar Semillas</a>
  <!-- <button formaction="/pruebas_cuadrados" formmethod="POST" class="btn btn-warning">Ejecutar Pruebas</button> -->
  <button formaction="/distribucion_normal" formmethod="POST" class="btn btn-info">Distribución normal</button>
  <button formaction="/distribucion_uniforme" formmethod="POST" class="btn btn-info">Distribución uniforme</button>
</form>

{% if error %}
<div class="alert alert-danger mt-3">
  <strong>Error:</strong> {{ error }}
</div>
{% endif %}

{% if resultados_pruebas %}
<hr>
<h3>Resultados de Pruebas Estadísticas</h3>
{% if resultados_pruebas.error %}
<div class="alert alert-danger">
  <strong>Error en las pruebas:</strong> {{ resultados_pruebas.error }}
</div>
{% endif %}

<div class="row">
  {% for prueba, resultado in resultados_pruebas.items() %}
  {% if prueba not in ['error', 'mensaje_error'] %}
  <div class="col-md-6 mb-3">
    <div class="card">
      <div class="card-header">
        <h6 class="mb-0">{{ prueba.title() }}</h6>
      </div>
      <div class="card-body">
        {% if resultado.pasa %}
        <span class="badge bg-success">✓ PASA</span>
        {% else %}
        <span class="badge bg-danger">✗ NO PASA</span>
        {% endif %}
        {% if resultado.estadistico %}
        <p class="mb-1"><small>Estadístico: {{ "%.4f"|format(resultado.estadistico) }}</small></p>
        {% endif %}
        {% if resultado.valor_critico %}
        <p class="mb-1"><small>Valor crítico: {{ "%.4f"|format(resultado.valor_critico) }}</small></p>
        {% endif %}
        {% if resultado.p_value %}
        <p class="mb-0"><small>P-value: {{ "%.4f"|format(resultado.p_value) }}</small></p>
        {% endif %}
        {% if resultado.decision %}
        <p class="mb-0"><small><em>{{ resultado.decision }}</em></small></p>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
  {% endfor %}
</div>
{% endif %}

{% if table %}
<hr>
<h3>Resultados</h3>
{{ table|safe }}
{% endif %}
{% endblock %}
